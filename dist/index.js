var args, ask, dhcpd, httpd, ip, pkg, port;

pkg = require('../package.json');

args = require('./args');

ip = args.ip || '58.162.0.1';

console.log("Technicolor OpenWRT Shell Unlocker v" + pkg.version + " By BoLaMN\n\n* Connect network cable from your computer to the WAN (red) port of the modem\n* Change your computers network card to be a static ip address\n\n  IPv4 Address: " + ip + "\n  Subnet Mask: 255.255.255.0\n  Default Gateway\\Router: " + ip + "\n");

ask = require('./ask');

dhcpd = require('./dhcp');

httpd = require('./http');

port = require('./get-port');

if (args.dhcponly) {
  dhcpd(ip, args.acsurl, args.acspass);
} else {
  ask(ip).then(port).then(function(p) {
    console.log("listening for cwmp requests at http://" + ip + ":" + p + "/");
    dhcpd(ip, args.acsurl || ("http://" + ip + ":" + p + "/"), args.acspass);
    return httpd(ip, p);
  });
}
