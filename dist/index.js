var args, ask, dhcpd, httpd, ip, pass, pkg, port, url;

pkg = require('../package.json');

args = require('./args');

ip = args.ip || '58.162.0.1';

console.log("Technicolor OpenWRT Shell Unlocker v" + pkg.version + " By BoLaMN\n\n* Connect network cable from your computer to the WAN (red) port of the modem\n* Change your computers network card to be a static ip address\n\n  IPv4 Address: " + ip + "\n  Subnet Mask: 255.255.255.0\n  Default Gateway\\Router: " + ip + "\n");

ask = require('./ask');

dhcpd = require('./dhcp');

httpd = require('./http');

port = require('./get-port');

url = args.acsurl || ("http://" + ip + ":" + port + "/");

pass = args.acspass;

if (args.dhcponly) {
  dhcpd(ip, url, pass);
} else {
  ask(ip).then(port).then(function(p) {
    dhcpd(ip, url);
    return httpd(ip, p);
  });
}
