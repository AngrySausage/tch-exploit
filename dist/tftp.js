var fs, tftp;

fs = require('fs');

tftp = require('tftp');

module.exports = function(host, firmware, callback) {
  return fs.stat(firmware, function(err, stats) {
    var client;
    if (err) {
      return callback(err);
    }
    if (stats.isDirectory()) {
      return callback(new Error('You specify a file, not a directory.'));
    }
    client = tftp.createClient({
      host: host,
      timeout: 10000,
      retries: 10
    });
    console.log('### TFTP PUT ' + firmware + ' to ' + host);
    return client.put(firmware, callback);
  });
};
